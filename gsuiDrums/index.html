<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1"/>
<link rel="shortcut icon" href="../assets/favicon.png"/>
<link rel="stylesheet" href="../assets/fonts/fonts.css"/>

<!-- ....................................................................... -->
<link rel="stylesheet" href="../gsui.css"/>
<link rel="stylesheet" href="../gsui-flex.css"/>
<link rel="stylesheet" href="../test-assets/test.css"/>
<link rel="stylesheet" href="../gsuiIcon/gsuiIcon.css"/>

<!-- ....................................................................... -->
<link rel="stylesheet" href="../gsuiReorder/gsuiReorder.css"/>
<link rel="stylesheet" href="../gsuiScrollShadow/gsuiScrollShadow.css"/>
<link rel="stylesheet" href="../gsuiBeatlines/gsuiBeatlines.css"/>
<link rel="stylesheet" href="../gsuiSlider/gsuiSlider.css"/>
<link rel="stylesheet" href="../gsuiToggle/gsuiToggle.css"/>
<link rel="stylesheet" href="../gsuiTimeline/gsuiTimeline.css"/>
<link rel="stylesheet" href="../gsuiTimewindow/gsuiTimewindow.css"/>
<link rel="stylesheet" href="../gsuiSliderGroup/gsuiSliderGroup.css"/>
<link rel="stylesheet" href="../gsuiDrum/gsuiDrum.css"/>
<link rel="stylesheet" href="../gsuiPropSelect/gsuiPropSelect.css"/>
<link rel="stylesheet" href="../gsuiDrumrow/gsuiDrumrow.css"/>
<link rel="stylesheet" href="../gsuiDrumrows/gsuiDrumrows.css"/>

<!-- ....................................................................... -->
<link rel="stylesheet" href="gsuiDrums.css"/>

<!-- ....................................................................... -->
<style>
body {
	--test-content-w: 600px;
	--test-content-h: 400px;
	--test-content-resize: both;
}
</style>
</head>
<body>

<!-- ....................................................................... -->
<div id="TEST" data-min-x-auto>
	<gsui-drums timedivision="4/4"></gsui-drums>
</div>

<!-- ....................................................................... -->
<script src="../gs-utils/gs-utils.js"></script>
<script src="../gs-utils/gs-utils-dom.js"></script>
<script src="../gs-utils/gs-utils-math.js"></script>
<script src="../gs-utils/gs-utils-func.js"></script>
<script src="../gs-utils/gs-utils-checkType.dev.js"></script>
<script src="../gs-utils/gs-utils-audio-nodes.dev.js"></script>
<script src="../gs-utils/gs-utils-json.js"></script>
<script src="../test-assets/test.js"></script>
<script src="../gsui0ne/gsui0ne.js"></script>

<!-- ....................................................................... -->
<script src="../gsuiReorder/gsuiReorder.js"></script>
<script src="../gsuiScrollShadow/gsuiScrollShadow.js"></script>
<script src="../gsuiBeatlines/gsuiBeatlines.html.js"></script>
<script src="../gsuiBeatlines/gsuiBeatlines.js"></script>
<script src="../gsuiSlider/gsuiSlider.html.js"></script>
<script src="../gsuiSlider/gsuiSlider.js"></script>
<script src="../gsuiToggle/gsuiToggle.js"></script>
<script src="../gsuiSVGPatterns/gsuiSVGPatterns.js"></script>
<script src="../gsuiWaveform/gsuiWaveform.js"></script>
<script src="../gsuiTimeline/gsuiTimeline.html.js"></script>
<script src="../gsuiTimeline/gsuiTimeline.js"></script>
<script src="../gsuiTimewindow/gsuiTimewindow.html.js"></script>
<script src="../gsuiTimewindow/gsuiTimewindow.js"></script>
<script src="../gsuiSliderGroup/gsuiSliderGroup.html.js"></script>
<script src="../gsuiSliderGroup/gsuiSliderGroup.js"></script>
<script src="../gsuiDrum/gsuiDrum.html.js"></script>
<script src="../gsuiDrum/gsuiDrum.js"></script>
<script src="../gsuiDrum/gsuiDrumcut.js"></script>
<script src="../gsuiPropSelect/gsuiPropSelect.js"></script>
<script src="../gsuiDrumrow/gsuiDrumrow.html.js"></script>
<script src="../gsuiDrumrow/gsuiDrumrow.js"></script>
<script src="../gsuiDrumrows/gsuiDrumrows.js"></script>

<!-- ....................................................................... -->
<script src="gsuiDrums.html.js"></script>
<script src="gsuiDrums.js"></script>

<!-- ....................................................................... -->
<script>
const drums = GSUdomQS( "gsui-drums" );
const ctx = GSUaudioContext();

initRow( 0, "dr0", "kick 017", 0, 0, 1, "kick-017" );
initRow( 1, "dr1", "clap 013", 0, .2, .7, "clap-013" );
initRow( 2, "dr2", "hat 024", 0, .2, .7, "hat-024" );
initRow( 3, "dr3", "openhat 012", .2, -.5, .6, "openhat-012" );
initRow( 4, "dr4", "snare 018", 0, 0, .5, "snare-018" );

drums.$addDrum( "d00", { row: "dr0", when: .00 } );
drums.$addDrum( "d01", { row: "dr0", when: .25 } );
drums.$addDrum( "d02", { row: "dr0", when: .50 } );
drums.$addDrum( "d04", { row: "dr0", when: .75 } );
drums.$addDrum( "d05", { row: "dr0", when: 1 } );
drums.$changeDrum( "d00", "gain", .5 );
drums.$addDrumcut( "dc00", { row: "dr0", when: 1 } );

drums.$addDrum( "d10", { row: "dr1", when: 1.00 } );
drums.$addDrum( "d11", { row: "dr1", when: 1.25 } );
drums.$addDrum( "d12", { row: "dr1", when: 1.50 } );
drums.$addDrum( "d13", { row: "dr1", when: 1.75 } );
drums.$addDrum( "d14", { row: "dr1", when: 2 } );
drums.$changeDrum( "d10", "gain", .5 );
drums.$changeDrum( "d10", "pan", .5 );
drums.$changeDrum( "d11", "pan", 1 );
drums.$changeDrum( "d12", "pan", -.5 );
drums.$changeDrum( "d13", "pan", -1 );

drums.$addDrumcut( "dc10", { row: "dr1", when: 2 } );

drums.$addDrum( "d30", { row: "dr3", when: 2 } );

drums.$addDrum( "d21", { row: "dr2", when: 2 } );
drums.$addDrum( "d31", { row: "dr3", when: 2.125 } );

drums.$addDrum( "d45", { row: "dr4", when: 2.0 } );
drums.$addDrum( "d46", { row: "dr4", when: 2.0625 } );
drums.$addDrum( "d41", { row: "dr4", when: 2.1875 } );
drums.$removeDrum( "d46" );

// drums.$addDrum( "d34", { row: "dr3", when: 3 } );
// drums.$addDrum( "d32", { row: "dr3", when: 3.0625 } );
drums.$addDrum( "d33", { row: "dr3", when: 3.125 } );

drums.$addDrum( "d42", { row: "dr4", when: 3.0625 } );
drums.$addDrum( "d43", { row: "dr4", when: 3.125 } );
drums.$addDrum( "d44", { row: "dr4", when: 3 } );

drums.$addDrum( "d15", { row: "dr1", when: 3 } );
drums.$addDrum( "d16", { row: "dr1", when: 3.125 } );
drums.$addDrum( "d17", { row: "dr1", when: 3.1875 } );
drums.$addDrum( "d22", { row: "dr2", when: 3 } );
drums.$addDrum( "d23", { row: "dr2", when: 3.125 } );
drums.$removeDrum( "d16" );
drums.$removeDrum( "d17" );
drums.$removeDrum( "d23" );

function initRow( order, drumId, name, detune, pan, gain, bufName ) {
	drums.$addDrumrow( drumId );
	drums.$changeDrumrow( drumId, "name", name );
	drums.$changeDrumrow( drumId, "detune", detune );
	drums.$changeDrumrow( drumId, "pan", pan );
	drums.$changeDrumrow( drumId, "gain", gain );
	drums.$changeDrumrow( drumId, "order", order );
	fetch( `../test-assets/${ bufName }.wav` )
		.then( res => res.arrayBuffer() )
		.then( arr => ctx.decodeAudioData( arr ) )
		.then( buf => {
			gsuiSVGPatterns.$add( "buffer", bufName );
			gsuiSVGPatterns.$add( "bufferHD", bufName );
			gsuiSVGPatterns.$update( "buffer", bufName, buf );
			drums.$changeDrumrow( drumId, "pattern", gsuiSVGPatterns.$createSVG( "bufferHD", bufName ) );
		} );
}
</script>
</body>
</html>
